(() => {"use strict";const accordionState = new Map();function loadPage(page, targetId, cb) {const cacheBust = "?_t=" + Date.now();fetch(`/pages/${page}.html${cacheBust}`).then((res) => (res.ok ? res.text() : Promise.reject())).then((html) => {document.getElementById(targetId).innerHTML = html;cb && cb();}).catch(() => {document.getElementById(targetId).innerHTML ="<p>Fehler beim Laden. Bitte versuchen Sie es erneut.</p>";cb && cb();});}function fadeOut(el, duration, cb) {el.style.transition = "opacity " + duration + "ms";el.style.opacity = "0";setTimeout(() => {el.style.display = "none";el.style.opacity = "";el.style.transition = "";cb && cb();}, duration);}function fadeIn(el, duration) {el.style.opacity = "0";el.style.display = "block";el.style.transition = "opacity " + duration + "ms";setTimeout(() => (el.style.opacity = "1"), 10);setTimeout(() => {el.style.transition = "";}, duration);}function updateAccordionAria() {document.querySelectorAll('input[type="radio"][name="rdo"]').forEach((input) => {const label = document.querySelector(`label.cat[for="${input.id}"]`);if (!label) return;if (input.checked) {label.classList.add("expanded");label.setAttribute("aria-expanded", "true");} else {label.classList.remove("expanded");label.setAttribute("aria-expanded", "false");}});}window.kb_source_2_datenschutz = function () {loadPage("datenschutz", "datenschutz", () => {});document.getElementById("datenschutz-p").style.display = "block";document.getElementById("fade").style.display = "block";};window.kb_source_2_impressum = function () {loadPage("impressum", "impressum", () => {});document.getElementById("impressum-p").style.display = "block";document.getElementById("fade").style.display = "block";};window.kb_source_2_vita = function () {document.getElementById("vita-p").style.display = "block";document.getElementById("fade").style.display = "block";};document.addEventListener("DOMContentLoaded", function () {const fade = document.getElementById("fade");if (fade) {fade.addEventListener("click", function () {document.querySelectorAll(".white_content").forEach((el) => (el.style.display = "none"));fade.style.display = "none";});}document.querySelectorAll('input[type="radio"][name="rdo"]').forEach((input) => {accordionState.set(input.id, input.checked);});document.querySelectorAll('label.cat[for^="tog"]').forEach((label) => {label.addEventListener("keydown", function (event) {if (event.key === "Enter" || event.key === " ") {event.preventDefault();this.click();}});});document.querySelectorAll('input[type="radio"][name="rdo"]').forEach((input) => {input.addEventListener("click", function () {const prevState = accordionState.get(this.id);document.querySelectorAll('input[type="radio"][name="rdo"]').forEach((other) => {if (other !== this) {other.checked = false;accordionState.set(other.id, false);}});this.checked = !prevState;accordionState.set(this.id, !prevState);updateAccordionAria();});});updateAccordionAria();document.addEventListener("click", function (event) {const target = event.target.closest('a[href^="#tog"]');if (!target) return;event.preventDefault();const id = target.getAttribute("href").substring(1);const input = document.getElementById(id);if (!input) return;document.querySelectorAll('input[type="radio"][name="rdo"]').forEach((other) => {if (other !== input) {other.checked = false;accordionState.set(other.id, false);}});input.checked = true;accordionState.set(id, true);updateAccordionAria();const label = document.querySelector(`label.cat[for="${id}"]`);if (label) {const y = label.getBoundingClientRect().top + window.pageYOffset - 20;window.scrollTo({ top: y, behavior: "smooth" });}});document.addEventListener("click", function (event) {const closeBtn = event.target.closest("[data-close-lightbox]");if (!closeBtn) return;event.preventDefault();const id = closeBtn.dataset.closeLightbox;const panel = document.getElementById(id);const fadeOverlay = document.getElementById("fade");if (panel) panel.style.display = "none";if (fadeOverlay) fadeOverlay.style.display = "none";});document.addEventListener("click", function (event) {if (event.target.closest("[data-open-impressum]")) {event.preventDefault();kb_source_2_impressum();}});document.addEventListener("click", function (event) {if (event.target.closest("[data-open-datenschutz]")) {event.preventDefault();kb_source_2_datenschutz();}});document.addEventListener("click", function (event) {if (event.target.closest("[data-open-vita]")) {event.preventDefault();kb_source_2_vita();}});document.querySelectorAll(".contact-form").forEach((form) => {form.addEventListener("submit", function (event) {event.preventDefault();const section = this.closest(".contact-form-section");const successBox = section?.querySelector(".form-success");const errorBox = section?.querySelector(".form-error");const submitBtn = this.querySelector(".form-submit");const originalText = submitBtn ? submitBtn.textContent : "";if (errorBox) errorBox.style.display = "none";if (submitBtn) {submitBtn.disabled = true;submitBtn.textContent = "...";}const formData = new FormData(this);fetch(this.action, {method: "POST",body: formData,headers: { Accept: "application/json" },}).then((res) => {if (!res.ok) throw new Error("Server error");fadeOut(form, 300, () => {if (successBox) fadeIn(successBox, 300);if (submitBtn) submitBtn.textContent = originalText;});}).catch(() => {if (submitBtn) {submitBtn.disabled = false;submitBtn.textContent = originalText;}if (errorBox) errorBox.style.display = "block";});});});});})();